<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- CSS de Bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Trispace:wght@300;400;600&display=swap");

            :root {
                --bs-body-font-family: "Trispace", sans-serif;
                --bs-body-color: #eef;
                --bs-body-bg: #10121c;
            }
        </style>
        <title>Introducción al Desarrollo Front End con HTML, CSS y JavaScript</title>
    </head>
    <body>
        <header>
            <div class="container">
                <div class="row pt-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                        <h1 class="display-4 text-center py-2">Breaking Bad</h1>
                        <p class="lead">
                            Una serie de televisión dramática estadounidense creada y producida por Vince Gilligan. Narra la historia de Walter White, un profesor de química que se transforma en el temido Heisenjaur.
                        </p>
                        <p>
                            lalala lalalal alala la alaaa.
                        </p>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <div class="accordion mx-md-5 my-5 rounded-0" id="accordionExample">
                <!--Edades de pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header bg-dark" id="headingOne">
                        <button class="accordion-button rounded-0" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Primer Gráfico</button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Primer gráfico: Explique.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="primerChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Pasajeras y pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Segundo gráfico</button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Segundo gráfico: Explique.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="segundoChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Tercer gráfico</button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Tercer gráfico: Explique.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="tercerChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Sobrevivientes por clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">Cuarto gráfico</button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Cuarto gráfico: Explique.</p>
                            <canvas id="cuartoChart" width="100" height="60"></canvas>
                        </div>
                    </div>
                </div>
                <!--Mujeres y niños primero-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">Quinto gráfico</button>
                    </h2>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Quinto gráfico: Explique.</p>
                            <canvas id="quintoChart" width="100" height="30"></canvas>
                        </div>
                    </div>
                </div>
                <!--Extra-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingSix">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseFive">Sexto gráfico</button>
                    </h2>
                    <div id="collapseSix" class="accordion-collapse collapse" aria-labelledby="headingSix" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Sexto gráfico: Explique.</p>
                            <canvas id="sextoChart" width="100" height="50"></canvas>
                        </div>
                    </div>
                </div>
                <!--Mujeres y niños primero-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingSeven">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">Séptimo gráfico</button>
                    </h2>
                    <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Séptimo gráfico: Explique.</p>
                            <canvas id="septimoChart" width="100" height="50"></canvas>
                        </div>
                    </div>
                </div>
                <!--Fin-->
            </div>
            <div class="row">
                <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                    <p>Los registros de 891 representan una parte de los más de 2.400 personas que viajaban en el Titanic aquel fatídico 14 de abril de 1912, cuando la nave choca con el iceberg faltando minutos para la medianoche.</p>
                </div>
            </div>
        </main>

        <aside>
            <div class="container">
                <div class="row py-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto small text-center">
                        <p>
                            Fuentes: <a href="https://historia.nationalgeographic.com.es/a/historia-titanic-tragedia-barco-insumergible_16344">La historia del Titanic, la tragedia del barco insumergible</a>,
                            <a href="https://rpubs.com/paraneda/titanic">RPubs - Titanic</a>, otra y otra más.
                        </p>
                    </div>
                </div>
            </div>
        </aside>

        <footer>
            <div class="container">
                <div class="row">
                    <div class="col"><p class="text-muted mt-5 text-center small">Bootstrap v5.1 y Charts.js</p></div>
                </div>
            </div>
        </footer>

        <!-- Biblioteca de Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <!-- Biblioteca Chart.js -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
            integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <!-- Un gran script, que contiene una función asincrónica para ir a buscar un JSON con -->
        <script>
            async function todo() {
                //el fetch
                const consulta = await fetch("https://raw.githubusercontent.com/camilasaezso/datos-05-05/main/datos.json");
                const data = await consulta.json();
                //algunas variables para calcular
                console.log(data);

                var generoDrama = 0;
                var generoComedia = 0;
                var generoEtc = 0;

                var DramaNombre = [];
                var DramaRating = [];

                //consultando en cada elemento del arreglo
                data.forEach((d) => {
                    if (d.Genre == "Drama") {
                        generoDrama = generoDrama + 1;
                        DramaNombre.push(d.Title);
                        DramaRating.push(d.IMDB_Rating);
                    } else if (d.Genre == "Comedy") {
                        generoComedia = generoComedia + 1;
                    } else {
                        generoEtc = generoEtc + 1;
                    }
                });

                console.log(DramaNombre);
                console.log(DramaRating);

                //edades
                new Chart(document.getElementById("primerChart").getContext("2d"), {
                    type: "pie",
                    data: {
                        labels: ["Drama", "Comedia", "Otros géneros"],
                        datasets: [{ data: [generoDrama, generoComedia, generoEtc], label: "Total", backgroundColor: ["#f00", "#00f", "#0ff"] }],
                    },
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });

                //hombres y mujeres
                new Chart(document.getElementById("segundoChart").getContext("2d"), {
                    type: "doughnut",
                    data: {
                        labels: ["Mujeres", "Hombres"],
                        datasets: [{ data: [30, 20], label: "Sexo", backgroundColor: ["#8856a7", "#495F8F"] }],
                    },
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });

                // clases
                new Chart(document.getElementById("tercerChart").getContext("2d"), {
                    type: "doughnut",
                    data: {
                        labels: ["Primera clase", "Segunda clase", "Tercera clase"],
                        datasets: [{ data: [12, 39, 17], label: "Clases titanic", backgroundColor: ["#D9B4B2", "#9EBCDA", "#495F8F"] }],
                    },
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });

                //sobrevivientes y muertes por clase
                new Chart(document.getElementById("cuartoChart").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: DramaNombre,
                        datasets: [{ data: DramaRating, label: "Sobreviven", backgroundColor: ["#8CB1E5"] }],
                    },
                    options: {
                        indexAxis: "y",
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });

                //sobrevivientes y muertes por edad y sexo (mujeres y niños primero)
                new Chart(document.getElementById("quintoChart").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: ["Mujeres", "Niños", "Hombres"],
                        datasets: [
                            { data: [30, 43, 40], label: "Sobreviven", backgroundColor: ["#8CB1E5"] },
                            { data: [52, 23, 123], label: "Mueren", backgroundColor: ["#334"] },
                        ],
                    },
                    options: {
                        indexAxis: "y",
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });
            }
            todo().catch((error) => console.error(error));
        </script>
        <!--otro para los extras-->
        <script>
            // No todo se resuelve con pie, doughthout o barras, a veces se necesitan otros gráficos

            async function otro() {
                //el fetch
                const consulta = await fetch("https://raw.githubusercontent.com/JM-Benites/datasets/main/datos.json");
                const data = await consulta.json();
                var puntos = [];
                var globosPrimera = [];
                var globosSegunda = [];
                var globosTercera = [];
                var globosCuarta = [];

                data.forEach((d) => {
                    let info = { x: d.presupuesto, y: d.ingreso_mundial, pelicula: d.pelicula };
                    let otra = { x: d.presupuesto, y: d.ingreso_mundial, pelicula: d.pelicula };

                    if (d.fase == 1) {
                        globosPrimera.push(otra);
                    } else if (d.fase == 2) {
                        globosSegunda.push(otra);
                    } else if (d.fase == 3) {
                        globosTercera.push(otra);
                    } else {
                        globosCuarta.push(otra)
                    }
                    puntos.push(info);
                });

                console.log(puntos);
                //Gráfico de dispersión
                //Para evidenciar si existe una relación o correlación entre las dos variables
                new Chart(document.getElementById("sextoChart").getContext("2d"), {
                    type: "scatter",
                    data: {
                        datasets: [
                            {
                                label: "Presupuesto contra ingreso",
                                data: puntos,
                                backgroundColor: "rgba(0,100,255,.5)",
                                pointRadius: 10,
                                pointHoverRadius: 12,
                            },
                        ],
                    },
                    options: {
                        animation: false,
                        scales: {
                            x: {
                                min:0,
                                ticks: {
                                    callback: function (numero) {
                                        return "US$ " + numero.toLocaleString("es-CL");
                                    },
                                },
                            },
                            y: {
                                min:0,
                                ticks: {
                                    callback: function (numero) {
                                        return "US$ " + numero.toLocaleString("es-CL");
                                    },
                                },
                            },
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        console.log(context);
                                        return "«" + context.raw.pelicula + "» tuvo ingresos mundiales por US$" + context.raw.y.toLocaleString("es-CL");
                                    },
                                },
                            },
                        },
                    },
                });
                //Gráfico de burbujas
                //Para analizar patrones o correlaciones de dos valores, considerando un tercer valor que se presenta en su radio

                new Chart(document.getElementById("septimoChart").getContext("2d"), {
                    type: "scatter",
                    data: {
                        datasets: [
                            {
                                label: "Fase 1",
                                data: globosPrimera,
                                backgroundColor: "rgba(245,191,83,.75)",
                                pointRadius: 10,
                                pointHoverRadius: 12,                              
                            },
                            {
                                label: "Fase 2",
                                data: globosSegunda,
                                backgroundColor: "rgba(230,105,101,.75)",
                                pointRadius: 10,
                                pointHoverRadius: 12,
                            },
                            {
                                label: "Fase 3",
                                data: globosTercera,
                                backgroundColor: "rgba(249,98,252,.75)",
                                pointRadius: 10,
                                pointHoverRadius: 12,
                            },
                            {
                                label: "Fase 4",
                                data: globosCuarta,
                                backgroundColor: "rgba(148,95,245,.75)",
                                pointRadius: 10,
                                pointHoverRadius: 12,
                            }
                        ],
                    },
                    options: {
                        animation: false,
                        scales: {
                            x: {
                                ticks: {
                                    callback: function (numero) {
                                        return "US$ " + numero.toLocaleString("es-CL");
                                    },
                                },
                            },
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        console.log(context);
                                        return "«" + context.raw.pelicula + "» tuvo ingresos mundiales por US$" + context.raw.y.toLocaleString("es-CL");
                                    },
                                },
                            },
                        },
                    },
                });
            }
            otro().catch((error) => console.error(error));
        </script>
    </body>
</html>